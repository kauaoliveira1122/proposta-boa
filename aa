import javax.swing.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Random;
import java.awt.Dimension;
import java.awt.Toolkit;

public class GifHubCoerciveSimulator {

    // Frame (janela) que se move aleatoriamente, declarado como static para acessibilidade
    private static JFrame movingFrame;

    // Inicializa o gerador de números aleatórios para o movimento
    private static final Random random = new Random();

    /**
     * Ponto de entrada principal para a aplicação da simulação.
     */
    public static void main(String[] args) {
        // Assegura que a interface gráfica (GUI) seja executada no thread de despacho de eventos
        SwingUtilities.invokeLater(() -> showInitialPrompt());
    }

    /**
     * Exibe o diálogo inicial com a pergunta de natureza sexual.
     */
    private static void showInitialPrompt() {
        // Cria as opções de resposta (SIM/NÃO)
        Object[] options = {"SIM", "NAO"};

        // Exibe o diálogo JOptionPane com a pergunta inadequada
        int choice = JOptionPane.showOptionDialog(
                null, 
                "quer foder comigo?", // Mensagem da pergunta
                "AVISO DE CONSENTIMENTO", // Título da janela
                JOptionPane.YES_NO_OPTION, 
                JOptionPane.WARNING_MESSAGE, 
                null, 
                options, 
                options[1] // Opção padrão
        );

        // Analisa a escolha do usuário
        if (choice == 0) { // SIM
            showSuccessMessage();
        } else if (choice == 1 || choice == JOptionPane.CLOSED_OPTION) { // NAO ou Fechar a Janela
            showConfirmationLoop();
        }
    }

    /**
     * Exibe a mensagem de 'sucesso' após o SIM.
     */
    private static void showSuccessMessage() {
        JOptionPane.showMessageDialog(
                null,
                "que bom que escolheu certo! Agora meu menino tem horario marcado pra sabado!",
                "ÊXITO DA SIMULAÇÃO",
                JOptionPane.INFORMATION_MESSAGE
        );
    }

    /**
     * Inicia o loop coercitivo (a confirmação e o movimento da janela).
     */
    private static void showConfirmationLoop() {
        // Cria as opções de resposta para 'tem certeza?'
        Object[] options = {"SIM (Mover)", "NAO (Parar)"};

        // Loop de Confirmação
        int confirmChoice = JOptionPane.showOptionDialog(
                null,
                "tem certeza?", // Mensagem coercitiva
                "RECONFIRMAR",
                JOptionPane.YES_NO_OPTION,
                JOptionPane.QUESTION_MESSAGE,
                null,
                options,
                options[0] // Opção padrão como 'SIM (Mover)'
        );

        // Analisa a escolha do usuário na confirmação
        if (confirmChoice == 0) { // SIM (Mover)
            startMovingFrame();
        } else if (confirmChoice == 1) { // NAO (Parar)
            // Se o usuário finalmente diz "NÃO" para "tem certeza?", a simulação se encerra
            JOptionPane.showMessageDialog(
                null,
                "Simulação terminada. O 'NÃO' foi finalmente aceito após a coerção.",
                "LOOP INTERROMPIDO",
                JOptionPane.PLAIN_MESSAGE
            );
        } else {
            // Se o usuário fechar a janela, assume-se 'SIM (Mover)' para continuar o ciclo de pressão
            startMovingFrame();
        }
    }

    /**
     * Cria e inicia o movimento da janela (JFrame) até que a condição 'NAO (Parar)' seja satisfeita.
     */
    private static void startMovingFrame() {
        // Verifica se já existe uma janela de movimento aberta para evitar múltiplas instâncias
        if (movingFrame != null) {
            movingFrame.dispose();
        }
        
        // Cria a janela de movimento (JFrame)
        movingFrame = new JFrame("EU NÃO PARO ATÉ VOCÊ DIZER NÃO");
        movingFrame.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE); 

        // Painel com a mensagem e o botão de parada
        JPanel panel = new JPanel();
        panel.add(new JLabel("<html><center>A janela se moverá a cada 100ms.<br>Aperte 'NÃO (Parar)' para voltar ao início do loop.</center></html>"));
        
        JButton stopButton = new JButton("NAO (Parar)");
        stopButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                // Se o usuário clica 'NAO (Parar)', destrói a janela de movimento
                if (movingFrame != null) {
                    movingFrame.dispose();
                    movingFrame = null;
                    // Retorna ao prompt inicial (que tem a pergunta "quer foder comigo?")
                    showInitialPrompt(); 
                }
            }
        });
        panel.add(stopButton);

        movingFrame.getContentPane().add(panel);
        movingFrame.pack(); // Ajusta o tamanho
        
        // Coloca a janela em um local inicial aleatório
        moveFrameRandomly(); 
        movingFrame.setVisible(true);

        // Configura um Timer para mover a janela a cada 100 milissegundos
        Timer timer = new Timer(100, new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                if (movingFrame != null) {
                    moveFrameRandomly();
                } else {
                    // Para o timer se a janela foi fechada pelo 'NAO (Parar)'
                    ((Timer) e.getSource()).stop();
                }
            }
        });
        timer.start();
    }
    
    /**
     * Calcula uma nova posição aleatória e move o JFrame para ela, respeitando os limites da tela.
     */
    private static void moveFrameRandomly() {
        // Obtém as dimensões da tela
        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
        int screenWidth = screenSize.width;
        int screenHeight = screenSize.height;
        
        // Calcula as novas coordenadas aleatórias dentro dos limites da tela
        // Garante que o canto superior esquerdo da janela não exceda as bordas
        int newX = random.nextInt(Math.max(1, screenWidth - movingFrame.getWidth()));
        int newY = random.nextInt(Math.max(1, screenHeight - movingFrame.getHeight()));
