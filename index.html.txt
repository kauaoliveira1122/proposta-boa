import javax.swing.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Random;

public class GifHubCoerciveSimulator {

    // Frame (janela) que se move aleatoriamente
    private static JFrame movingFrame;

    // Inicializa o gerador de números aleatórios para o movimento
    private static final Random random = new Random();

    /**
     * Ponto de entrada principal para a aplicação da simulação.
     */
    public static void main(String[] args) {
        // Assegura que a interface gráfica (GUI) seja executada no thread de despacho de eventos
        SwingUtilities.invokeLater(() -> showInitialPrompt());
    }

    /**
     * Exibe o diálogo inicial com a pergunta de natureza sexual.
     */
    private static void showInitialPrompt() {
        // Cria as opções de resposta (SIM/NÃO)
        Object[] options = {"SIM", "NAO"};

        // Exibe o diálogo JOptionPane com a pergunta inadequada
        int choice = JOptionPane.showOptionDialog(
                null, // Componente pai: null para o centro da tela
                "quer foder comigo?", // Mensagem da pergunta
                "AVISO DE CONSENTIMENTO", // Título da janela
                JOptionPane.YES_NO_OPTION, // Tipo de opção (SIM/NÃO)
                JOptionPane.WARNING_MESSAGE, // Tipo de ícone (Pode ser usado para dar ênfase)
                null, // Ícone customizado: null para o ícone padrão
                options, // As opções de botão
                options[1] // Opção padrão (para forçar o 'NÃO' inicial, conforme o desejo do usuário na simulação)
        );

        // Analisa a escolha do usuário
        if (choice == 0) { // SIM (opção 0)
            showSuccessMessage();
        } else if (choice == 1 || choice == JOptionPane.CLOSED_OPTION) { // NAO (opção 1) ou Fechar a Janela
            showConfirmationLoop();
        }
    }

    /**
     * Exibe a mensagem de 'sucesso' após o SIM.
     */
    private static void showSuccessMessage() {
        JOptionPane.showMessageDialog(
                null,
                "que bom que escolheu certo! Agora meu menino tem horario marcado pra sabado!",
                "ÊXITO DA SIMULAÇÃO",
                JOptionPane.INFORMATION_MESSAGE
        );
    }

    /**
     * Inicia o loop coercitivo (a confirmação e o movimento da janela).
     */
    private static void showConfirmationLoop() {
        // Cria as opções de resposta para 'tem certeza?'
        Object[] options = {"SIM (Mover)", "NAO (Parar)"};

        // Loop de Confirmação
        int confirmChoice = JOptionPane.showOptionDialog(
                null,
                "tem certeza?", // Mensagem coercitiva
                "RECONFIRMAR",
                JOptionPane.YES_NO_OPTION,
                JOptionPane.QUESTION_MESSAGE,
                null,
                options,
                options[0] // Opção padrão como 'SIM (Mover)', forçando o comportamento do movimento
        );

        // Analisa a escolha do usuário na confirmação
        if (confirmChoice == 0) { // SIM (Mover)
            startMovingFrame();
        } else if (confirmChoice == 1) { // NAO (Parar)
            // Se o usuário finalmente diz "NÃO" para "tem certeza?", a simulação simplesmente termina aqui
            JOptionPane.showMessageDialog(
                null,
                "Simulação terminada. O 'NÃO' foi finalmente aceito após a coerção.",
                "LOOP INTERROMPIDO",
                JOptionPane.PLAIN_MESSAGE
            );
        } else {
            // Se o usuário fechar a janela, a simulação se comporta como se fosse 'SIM (Mover)' para manter o ciclo coercitivo
            startMovingFrame();
        }
    }

    /**
     * Cria e inicia o movimento da janela (JFrame) até que a condição 'NAO (Parar)' seja satisfeita.
     */
    private static void startMovingFrame() {
        // Cria a janela de movimento (JFrame)
        movingFrame = new JFrame("EU NÃO PARO ATÉ VOCÊ DIZER NÃO");
        movingFrame.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE); // Impede o fechamento padrão

        // Painel com a mensagem e o botão de parada
        JPanel panel = new JPanel();
        panel.add(new JLabel("A janela se moverá até você apertar 'NÃO (Parar)' abaixo."));
        
        JButton stopButton = new JButton("NAO (Parar)");
        stopButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                // Se o usuário clica 'NAO (Parar)', destrói a janela de movimento
                if (movingFrame != null) {
                    movingFrame.dispose();
                    movingFrame = null;
                    // O loop de coerção é interrompido, mas o simulador retorna ao prompt inicial para recomeçar o ciclo de pressão
                    showInitialPrompt(); 
                }
            }
        });
        panel.add(stopButton);

        movingFrame.getContentPane().add(panel);
        movingFrame.pack(); // Ajusta o tamanho
        
        // Coloca a janela em um local inicial aleatório
        moveFrameRandomly(); 
        movingFrame.setVisible(true);

        // Configura um Timer para mover a janela a cada 100 milissegundos
        Timer timer = new Timer(100, new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                if (movingFrame != null) {
                    moveFrameRandomly();
                } else {
                    // Para o timer se a janela foi fechada pelo 'NAO (Parar)'
                    ((Timer) e.getSource()).stop();
                }
            }
        });
        timer.start();
    }
    
    /**
     * Calcula uma nova posição aleatória e move o JFrame para ela.
     */
    private static void moveFrameRandomly() {
        // Obtém as dimensões da tela
        int screenWidth = java.awt.Toolkit.getDefaultToolkit().getScreenSize().width;
        int screenHeight = java.awt.Toolkit.getDefaultToolkit().getScreenSize().height;
        
        // Calcula as novas coordenadas aleatórias
        int newX = random.nextInt(screenWidth - movingFrame.getWidth());
        int newY = random.nextInt(screenHeight - movingFrame.getHeight());
        
        // Move o frame
        movingFrame.setLocation(newX, newY);
    }
}